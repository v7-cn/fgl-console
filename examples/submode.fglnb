[{"kind":1,"language":"markdown","value":"# FGL 模式","outputs":[]},{"kind":2,"language":"fgl","value":"// %fgl\nPREDICT model.\"/model/output/path\" WHERE \n    bank = '/example/bank/bank' AND\n    card = '/example/bank/card' AND\n    person = '/example/bank/person'\nAS bb;\n","outputs":[{"mime":"text/html","value":"dag raw output test"},{"mime":"text/x-json","value":"{\n    \"aaa\": \"bbb\"\n}"}]},{"kind":1,"language":"markdown","value":"# DAG svg模式","outputs":[]},{"kind":2,"language":"fgl","value":"%dag\nPREDICT model.\"/model/output/path\" WHERE \n    bank = '/example/bank/bank' AND\n    card = '/example/bank/card' AND\n    person = '/example/bank/person'\nAS bb;","outputs":[{"mime":"text/html","value":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.40.1 (20161225.0304)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"512pt\" height=\"87pt\"\n viewBox=\"0.00 0.00 512.00 87.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 83)\">\n<title>%3</title>\n<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-83 508,-83 508,4 -4,4\"/>\n<g id=\"clust2\" class=\"cluster\">\n<title>cluster_L</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"8,-8 8,-71 290,-71 290,-8 8,-8\"/>\n</g>\n<g id=\"node1\" class=\"node\">\n<title></title>\n<polygon fill=\"none\" stroke=\"#b22800\" points=\"281.5,-63 16.5,-63 16.5,-16 281.5,-16 281.5,-63\"/>\n<text text-anchor=\"start\" x=\"24.5\" y=\"-49.4\" font-family=\"Times,serif\" font-size=\"12.00\" fill=\"#000000\">Note:</text>\n<text text-anchor=\"start\" x=\"24.5\" y=\"-36.4\" font-family=\"Times,serif\" font-size=\"12.00\" fill=\"#000000\">该DAG任务由 DSL 解析器生成</text>\n<text text-anchor=\"middle\" x=\"149\" y=\"-23.4\" font-family=\"Times,serif\" font-size=\"12.00\" fill=\"#000000\">DSL&#45;autogen&#45;ff2d0419388646a36f080ee321f2da31</text>\n</g>\n<!-- node_7acbdfdc -->\n<g id=\"node2\" class=\"node\">\n<title>node_7acbdfdc</title>\n<polygon fill=\"none\" stroke=\"#000000\" points=\"300,-5.5 300,-73.5 504,-73.5 504,-5.5 300,-5.5\"/>\n<text text-anchor=\"middle\" x=\"339\" y=\"-46.6\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">模型预测</text>\n<text text-anchor=\"middle\" x=\"339\" y=\"-37.6\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">ID: node_7acbdfdc</text>\n<text text-anchor=\"middle\" x=\"339\" y=\"-28.6\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">predict</text>\n<polyline fill=\"none\" stroke=\"#000000\" points=\"378,-5.5 378,-73.5 \"/>\n<text text-anchor=\"middle\" x=\"398\" y=\"-63.1\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">model:</text>\n<polyline fill=\"none\" stroke=\"#000000\" points=\"378,-56.5 418,-56.5 \"/>\n<text text-anchor=\"middle\" x=\"398\" y=\"-46.1\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">bank:</text>\n<polyline fill=\"none\" stroke=\"#000000\" points=\"378,-39.5 418,-39.5 \"/>\n<text text-anchor=\"middle\" x=\"398\" y=\"-29.1\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">card:</text>\n<polyline fill=\"none\" stroke=\"#000000\" points=\"378,-22.5 418,-22.5 \"/>\n<text text-anchor=\"middle\" x=\"398\" y=\"-12.1\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">person:</text>\n<polyline fill=\"none\" stroke=\"#000000\" points=\"418,-5.5 418,-73.5 \"/>\n<text text-anchor=\"middle\" x=\"461\" y=\"-63.1\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">/model/output/path</text>\n<polyline fill=\"none\" stroke=\"#000000\" points=\"418,-56.5 504,-56.5 \"/>\n<text text-anchor=\"middle\" x=\"461\" y=\"-46.1\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">/example/bank/bank</text>\n<polyline fill=\"none\" stroke=\"#000000\" points=\"418,-39.5 504,-39.5 \"/>\n<text text-anchor=\"middle\" x=\"461\" y=\"-29.1\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">/example/bank/card</text>\n<polyline fill=\"none\" stroke=\"#000000\" points=\"418,-22.5 504,-22.5 \"/>\n<text text-anchor=\"middle\" x=\"461\" y=\"-12.1\" font-family=\"Times,serif\" font-size=\"8.00\" fill=\"#000000\">/example/bank/person</text>\n</g>\n</g>\n</svg>\n"}]},{"kind":1,"language":"markdown","value":"# DAG json模式","outputs":[]},{"kind":2,"language":"fgl","value":"%dag+json\nPREDICT model.\"/model/output/path\" WHERE \n    bank = '/example/bank/bank' AND\n    card = '/example/bank/card' AND\n    person = '/example/bank/person'\nAS bb;","outputs":[{"mime":"text/x-json","value":"{\n    \"version\": \"1.0.0\",\n    \"canvas\": {\n        \"name\": \"DSL-autogen-b6071c749f049703a9cbe0b15c701fac\",\n        \"description\": \"该DAG任务由 DSL 解析器生成\",\n        \"position\": \"dsl\"\n    },\n    \"nodes\": [\n        {\n            \"id\": \"node_0b2ec925\",\n            \"name\": \"模型预测\",\n            \"module_id\": \"Predict\",\n            \"node_attrs\": {\n                \"model\": \"/model/output/path\",\n                \"bank\": \"/example/bank/bank\",\n                \"card\": \"/example/bank/card\",\n                \"person\": \"/example/bank/person\",\n                \"module\": \"predict\"\n            }\n        }\n    ],\n    \"edges\": []\n}"}]},{"kind":1,"language":"markdown","value":"# Python 脚本模式","outputs":[]},{"kind":2,"language":"fgl","value":"%python\nimport pandas as pd\ndf = pd.DataFrame([1,2,3], columns=['a'])\nreturn df","outputs":[{"mime":"text/html","value":"<table border=\"1\" class=\"dataframe table table-stripped\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>a</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n    </tr>\n  </tbody>\n</table>"}]},{"kind":1,"language":"markdown","value":"# Shell 脚本模式","outputs":[]},{"kind":2,"language":"fgl","value":"%sh\nsleep 1\necho 'hello world'\nls","outputs":[{"mime":"text/html","value":"hello world\ndata\ndot.png\nexamples\nfgl\nFGL.g4\ninitdb.py\ninterpreter\nlsp\nmagic.png\nMakefile\n__pycache__\npygls.log\nREADME.md\nsplatform\nt.dot\nUntitled.ipynb\n"}]},{"kind":1,"language":"markdown","value":"# 报错信息抛出","outputs":[]},{"kind":2,"language":"fgl","value":"// %fgl\nPREDICT model().\"/model/output/path\" WHERE \n    bank = '/example/bank/bank' AND\n    card = '/example/bank/card' AND\n    person = '/example/bank/person'\nAS bb;\n","outputs":[{"mime":"text/plain","value":"Traceback (most recent call last):\n  File \"/data1t/DSL/fgl-lang/fgl/dsl/FGLParser.py\", line 391, in prog\n    _alt = self._interp.adaptivePredict(self._input,1,self._ctx)\n  File \"/usr/local/python3/lib/python3.10/site-packages/antlr4/atn/ParserATNSimulator.py\", line 346, in adaptivePredict\n    alt = self.execATN(dfa, s0, input, index, outerContext)\n  File \"/usr/local/python3/lib/python3.10/site-packages/antlr4/atn/ParserATNSimulator.py\", line 418, in execATN\n    raise e\nantlr4.error.Errors.NoViableAltException: None\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/data1t/DSL/fgl-lang/interpreter/__init__.py\", line 168, in websocket_endpoint\n    result, config = interpreter(context=req.get('context', 'shell').lower(),\n  File \"/data1t/DSL/fgl-lang/interpreter/__init__.py\", line 122, in interpreter\n    _res = list(_interpreter(*args, **kwargs))\n  File \"/data1t/DSL/fgl-lang/interpreter/__init__.py\", line 53, in _interpreter\n    res = FGL().parse(statements, dumps=True)\n  File \"/data1t/DSL/fgl-lang/fgl/__init__.py\", line 31, in parse\n    s = visit(StatementSplitVisitor(), dsl)\n  File \"/data1t/DSL/fgl-lang/fgl/utils.py\", line 147, in visit\n    r =  visitor.visit(parser.prog())\n  File \"/data1t/DSL/fgl-lang/fgl/dsl/FGLParser.py\", line 424, in prog\n    self._errHandler.reportError(self, re)\n  File \"/usr/local/python3/lib/python3.10/site-packages/antlr4/error/ErrorStrategy.py\", line 126, in reportError\n    self.reportNoViableAlternative(recognizer, e)\n  File \"/usr/local/python3/lib/python3.10/site-packages/antlr4/error/ErrorStrategy.py\", line 261, in reportNoViableAlternative\n    recognizer.notifyErrorListeners(msg, e.offendingToken, e)\n  File \"/usr/local/python3/lib/python3.10/site-packages/antlr4/Parser.py\", line 322, in notifyErrorListeners\n    listener.syntaxError(self, offendingToken, line, column, msg, e)\n  File \"/usr/local/python3/lib/python3.10/site-packages/antlr4/error/ErrorListener.py\", line 60, in syntaxError\n    delegate.syntaxError(recognizer, offendingSymbol, line, column, msg, e)\n  File \"/data1t/DSL/fgl-lang/fgl/utils.py\", line 136, in syntaxError\n    raise DSLParseException(f\"{recog}, {symbol}, {line}, {col}, {msg}, {e}\")\nfgl.support.exceptions.DSLParseException: <fgl.dsl.FGLParser.FGLParser object at 0x7f3193abdc60>, [@4,23:23='.',<1>,2:15], 2, 15, no viable alternative at input 'PREDICTmodel().', None\n"}]},{"kind":2,"language":"fgl","value":"","outputs":[]}]